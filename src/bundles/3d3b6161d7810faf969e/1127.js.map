{"version":3,"file":"bundles/3d3b6161d7810faf969e/1127.js","mappings":"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","sources":["webpack://element-web/./src/async-components/views/dialogs/security/CreateSecretStorageDialog.tsx","webpack://element-web/./src/components/views/auth/PassphraseConfirmField.tsx","webpack://element-web/./src/tchap/util/TchapStrongPassword.tsx","webpack://element-web/./src/components/views/auth/PassphraseField.tsx","webpack://element-web/./src/utils/device/dehydration.ts","webpack://element-web/./node_modules/file-saver/src/FileSaver.js"],"sourcesContent":["/*\nCopyright 2024 New Vector Ltd.\nCopyright 2019, 2020 , 2023 The Matrix.org Foundation C.I.C.\nCopyright 2018, 2019 New Vector Ltd\n\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only\nPlease see LICENSE files in the repository root for full details.\n*/\n\nimport React, { createRef } from \"react\";\nimport FileSaver from \"file-saver\";\nimport { logger } from \"matrix-js-sdk/src/logger\";\nimport { AuthDict, CrossSigningKeys, MatrixError, UIAFlow, UIAResponse } from \"matrix-js-sdk/src/matrix\";\nimport { GeneratedSecretStorageKey } from \"matrix-js-sdk/src/crypto-api\";\nimport classNames from \"classnames\";\nimport CheckmarkIcon from \"@vector-im/compound-design-tokens/assets/web/icons/check\";\n\nimport { MatrixClientPeg } from \"../../../../MatrixClientPeg\";\nimport { _t, _td } from \"../../../../languageHandler\";\nimport Modal from \"../../../../Modal\";\nimport { copyNode } from \"../../../../utils/strings\";\nimport { SSOAuthEntry } from \"../../../../components/views/auth/InteractiveAuthEntryComponents\";\nimport PassphraseField from \"../../../../components/views/auth/PassphraseField\";\nimport StyledRadioButton from \"../../../../components/views/elements/StyledRadioButton\";\nimport AccessibleButton from \"../../../../components/views/elements/AccessibleButton\";\nimport DialogButtons from \"../../../../components/views/elements/DialogButtons\";\nimport InlineSpinner from \"../../../../components/views/elements/InlineSpinner\";\nimport {\n    getSecureBackupSetupMethods,\n    isSecureBackupRequired,\n    SecureBackupSetupMethod,\n} from \"../../../../utils/WellKnownUtils\";\nimport { ModuleRunner } from \"../../../../modules/ModuleRunner\";\nimport Field from \"../../../../components/views/elements/Field\";\nimport BaseDialog from \"../../../../components/views/dialogs/BaseDialog\";\nimport Spinner from \"../../../../components/views/elements/Spinner\";\nimport InteractiveAuthDialog from \"../../../../components/views/dialogs/InteractiveAuthDialog\";\nimport { IValidationResult } from \"../../../../components/views/elements/Validation\";\nimport PassphraseConfirmField from \"../../../../components/views/auth/PassphraseConfirmField\";\nimport { initialiseDehydration } from \"../../../../utils/device/dehydration\";\n\n// I made a mistake while converting this and it has to be fixed!\nenum Phase {\n    Loading = \"loading\",\n    LoadError = \"load_error\",\n    ChooseKeyPassphrase = \"choose_key_passphrase\",\n    Passphrase = \"passphrase\",\n    PassphraseConfirm = \"passphrase_confirm\",\n    ShowKey = \"show_key\",\n    Storing = \"storing\",\n    Stored = \"stored\",\n    ConfirmSkip = \"confirm_skip\",\n}\n\nconst PASSWORD_MIN_SCORE = 4; // So secure, many characters, much complex, wow, etc, etc.\n\ninterface IProps {\n    hasCancel?: boolean;\n    accountPassword?: string;\n    forceReset?: boolean;\n    resetCrossSigning?: boolean;\n    onFinished(ok?: boolean): void;\n}\n\ninterface IState {\n    phase: Phase;\n    passPhrase: string;\n    passPhraseValid: boolean;\n    passPhraseConfirm: string;\n    copied: boolean;\n    downloaded: boolean;\n    setPassphrase: boolean;\n\n    // does the server offer a UI auth flow with just m.login.password\n    // for /keys/device_signing/upload?\n    canUploadKeysWithPasswordOnly: boolean | null;\n    accountPassword: string;\n    accountPasswordCorrect: boolean | null;\n    canSkip: boolean;\n    passPhraseKeySelected: string;\n    error?: boolean;\n}\n\n/**\n * Walks the user through the process of creating a 4S passphrase and bootstrapping secret storage.\n *\n * If the user already has a key backup, follows a \"migration\" flow (aka \"Upgrade your encryption\") which\n * prompts the user to enter their backup decryption password (a Curve25519 private key, possibly derived\n * from a passphrase), and uses that as the (AES) 4S encryption key.\n */\nexport default class CreateSecretStorageDialog extends React.PureComponent<IProps, IState> {\n    public static defaultProps: Partial<IProps> = {\n        hasCancel: true,\n        forceReset: false,\n        resetCrossSigning: false,\n    };\n    private recoveryKey?: GeneratedSecretStorageKey;\n    private recoveryKeyNode = createRef<HTMLElement>();\n    private passphraseField = createRef<Field>();\n\n    public constructor(props: IProps) {\n        super(props);\n\n        const cli = MatrixClientPeg.safeGet();\n\n        let passPhraseKeySelected: SecureBackupSetupMethod;\n        const setupMethods = getSecureBackupSetupMethods(cli);\n        if (setupMethods.includes(SecureBackupSetupMethod.Key)) {\n            passPhraseKeySelected = SecureBackupSetupMethod.Key;\n        } else {\n            passPhraseKeySelected = SecureBackupSetupMethod.Passphrase;\n        }\n\n        const accountPassword = props.accountPassword || \"\";\n        let canUploadKeysWithPasswordOnly: boolean | null = null;\n        if (accountPassword) {\n            // If we have an account password in memory, let's simplify and\n            // assume it means password auth is also supported for device\n            // signing key upload as well. This avoids hitting the server to\n            // test auth flows, which may be slow under high load.\n            canUploadKeysWithPasswordOnly = true;\n        }\n\n        const keyFromCustomisations = ModuleRunner.instance.extensions.cryptoSetup.createSecretStorageKey();\n        const phase = keyFromCustomisations ? Phase.Loading : Phase.ChooseKeyPassphrase;\n\n        this.state = {\n            phase,\n            passPhrase: \"\",\n            passPhraseValid: false,\n            passPhraseConfirm: \"\",\n            copied: false,\n            downloaded: false,\n            setPassphrase: false,\n            // does the server offer a UI auth flow with just m.login.password\n            // for /keys/device_signing/upload?\n            accountPasswordCorrect: null,\n            canSkip: !isSecureBackupRequired(cli),\n            canUploadKeysWithPasswordOnly,\n            passPhraseKeySelected,\n            accountPassword,\n        };\n\n        // :TCHAP: remove-passphrase-4S\n        this.showKeyPassphraseDirectly();\n        // end :TCHAP:\n    }\n\n    public componentDidMount(): void {\n        const keyFromCustomisations = ModuleRunner.instance.extensions.cryptoSetup.createSecretStorageKey();\n        if (keyFromCustomisations) this.initExtension(keyFromCustomisations);\n\n        if (this.state.canUploadKeysWithPasswordOnly === null) {\n            this.queryKeyUploadAuth();\n        }\n    }\n\n    /**\n     * :TCHAP: remove-passphrase-4S\n     * We don't show the choice between passphrase and key, we directly show the key phase\n     */\n    private async showKeyPassphraseDirectly(): Promise<void> {\n        try {\n            this.recoveryKey = await MatrixClientPeg.safeGet().getCrypto()!.createRecoveryKeyFromPassphrase();\n            this.setState({\n                copied: false,\n                downloaded: false,\n                setPassphrase: false,\n                phase: Phase.ShowKey,\n                passPhraseKeySelected: SecureBackupSetupMethod.Key\n            });\n        } catch (e) {\n            console.error(\"Error fetching backup data from server\", e);\n            this.setState({ phase: Phase.LoadError });\n            return undefined;\n        }\n    }\n    // end :TCHAP:\n\n    private initExtension(keyFromCustomisations: Uint8Array): void {\n        logger.log(\"CryptoSetupExtension: Created key via extension, jumping to bootstrap step\");\n        this.recoveryKey = {\n            privateKey: keyFromCustomisations,\n        };\n        this.bootstrapSecretStorage();\n    }\n\n    private async queryKeyUploadAuth(): Promise<void> {\n        try {\n            await MatrixClientPeg.safeGet().uploadDeviceSigningKeys(undefined, {} as CrossSigningKeys);\n            // We should never get here: the server should always require\n            // UI auth to upload device signing keys. If we do, we upload\n            // no keys which would be a no-op.\n            logger.log(\"uploadDeviceSigningKeys unexpectedly succeeded without UI auth!\");\n        } catch (error) {\n            if (!(error instanceof MatrixError) || !error.data || !error.data.flows) {\n                logger.log(\"uploadDeviceSigningKeys advertised no flows!\");\n                return;\n            }\n            const canUploadKeysWithPasswordOnly = error.data.flows.some((f: UIAFlow) => {\n                return f.stages.length === 1 && f.stages[0] === \"m.login.password\";\n            });\n            this.setState({\n                canUploadKeysWithPasswordOnly,\n            });\n        }\n    }\n\n    private onKeyPassphraseChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\n        this.setState({\n            passPhraseKeySelected: e.target.value,\n        });\n    };\n\n    private onChooseKeyPassphraseFormSubmit = async (): Promise<void> => {\n        if (this.state.passPhraseKeySelected === SecureBackupSetupMethod.Key) {\n            this.recoveryKey = await MatrixClientPeg.safeGet().getCrypto()!.createRecoveryKeyFromPassphrase();\n            this.setState({\n                copied: false,\n                downloaded: false,\n                setPassphrase: false,\n                phase: Phase.ShowKey,\n            });\n        } else {\n            this.setState({\n                copied: false,\n                downloaded: false,\n                phase: Phase.Passphrase,\n            });\n        }\n    };\n\n    private onCopyClick = (): void => {\n        const successful = copyNode(this.recoveryKeyNode.current);\n        if (successful) {\n            this.setState({\n                copied: true,\n            });\n        }\n    };\n\n    private onDownloadClick = (): void => {\n        if (!this.recoveryKey) return;\n        const blob = new Blob([this.recoveryKey.encodedPrivateKey!], {\n            type: \"text/plain;charset=us-ascii\",\n        });\n        FileSaver.saveAs(blob, \"security-key.txt\");\n\n        this.setState({\n            downloaded: true,\n        });\n    };\n\n    private doBootstrapUIAuth = async (\n        makeRequest: (authData: AuthDict) => Promise<UIAResponse<void>>,\n    ): Promise<void> => {\n        if (this.state.canUploadKeysWithPasswordOnly && this.state.accountPassword) {\n            await makeRequest({\n                type: \"m.login.password\",\n                identifier: {\n                    type: \"m.id.user\",\n                    user: MatrixClientPeg.safeGet().getSafeUserId(),\n                },\n                password: this.state.accountPassword,\n            });\n        } else {\n            const dialogAesthetics = {\n                [SSOAuthEntry.PHASE_PREAUTH]: {\n                    title: _t(\"auth|uia|sso_title\"),\n                    body: _t(\"auth|uia|sso_preauth_body\"),\n                    continueText: _t(\"auth|sso\"),\n                    continueKind: \"primary\",\n                },\n                [SSOAuthEntry.PHASE_POSTAUTH]: {\n                    title: _t(\"encryption|confirm_encryption_setup_title\"),\n                    body: _t(\"encryption|confirm_encryption_setup_body\"),\n                    continueText: _t(\"action|confirm\"),\n                    continueKind: \"primary\",\n                },\n            };\n\n            const { finished } = Modal.createDialog(InteractiveAuthDialog, {\n                title: _t(\"encryption|bootstrap_title\"),\n                matrixClient: MatrixClientPeg.safeGet(),\n                makeRequest,\n                aestheticsForStagePhases: {\n                    [SSOAuthEntry.LOGIN_TYPE]: dialogAesthetics,\n                    [SSOAuthEntry.UNSTABLE_LOGIN_TYPE]: dialogAesthetics,\n                },\n            });\n            const [confirmed] = await finished;\n            if (!confirmed) {\n                throw new Error(\"Cross-signing key upload auth canceled\");\n            }\n        }\n    };\n\n    private bootstrapSecretStorage = async (): Promise<void> => {\n        const cli = MatrixClientPeg.safeGet();\n        const crypto = cli.getCrypto()!;\n        const { forceReset, resetCrossSigning } = this.props;\n\n        let backupInfo;\n        // First, unless we know we want to do a reset, we see if there is an existing key backup\n        if (!forceReset) {\n            try {\n                this.setState({ phase: Phase.Loading });\n                backupInfo = await crypto.getKeyBackupInfo();\n            } catch (e) {\n                logger.error(\"Error fetching backup data from server\", e);\n                this.setState({ phase: Phase.LoadError });\n                return;\n            }\n        }\n\n        this.setState({\n            phase: Phase.Storing,\n            error: undefined,\n        });\n\n        try {\n            if (forceReset) {\n                /* Resetting cross-signing requires secret storage to be reset\n                 * (otherwise it will try to store the cross-signing keys in the\n                 * old secret storage, and may prompt for the old key, which is\n                 * probably not available), and resetting key backup requires\n                 * cross-signing to be reset (so that the new backup can be\n                 * signed by the new cross-signing key).  So we reset secret\n                 * storage first, then cross-signing, then key backup.\n                 */\n                logger.log(\"Forcing secret storage reset\");\n                await crypto.bootstrapSecretStorage({\n                    createSecretStorageKey: async () => this.recoveryKey!,\n                    setupNewSecretStorage: true,\n                });\n                if (resetCrossSigning) {\n                    logger.log(\"Resetting cross signing\");\n                    await crypto.bootstrapCrossSigning({\n                        authUploadDeviceSigningKeys: this.doBootstrapUIAuth,\n                        setupNewCrossSigning: true,\n                    });\n                }\n                logger.log(\"Resetting key backup\");\n                await crypto.resetKeyBackup();\n            } else {\n                // For password authentication users after 2020-09, this cross-signing\n                // step will be a no-op since it is now setup during registration or login\n                // when needed. We should keep this here to cover other cases such as:\n                //   * Users with existing sessions prior to 2020-09 changes\n                //   * SSO authentication users which require interactive auth to upload\n                //     keys (and also happen to skip all post-authentication flows at the\n                //     moment via token login)\n                await crypto.bootstrapCrossSigning({\n                    authUploadDeviceSigningKeys: this.doBootstrapUIAuth,\n                });\n                await crypto.bootstrapSecretStorage({\n                    createSecretStorageKey: async () => this.recoveryKey!,\n                    setupNewKeyBackup: !backupInfo,\n                });\n            }\n            await initialiseDehydration(true);\n\n            this.setState({\n                phase: Phase.Stored,\n            });\n        } catch (e) {\n            this.setState({ error: true });\n            logger.error(\"Error bootstrapping secret storage\", e);\n        }\n    };\n\n    private onCancel = (): void => {\n        this.props.onFinished(false);\n    };\n\n    private onLoadRetryClick = (): void => {\n        this.bootstrapSecretStorage();\n    };\n\n    private onShowKeyContinueClick = (): void => {\n        this.bootstrapSecretStorage();\n    };\n\n    private onCancelClick = (): void => {\n        this.setState({ phase: Phase.ConfirmSkip });\n    };\n\n    private onGoBackClick = (): void => {\n        this.setState({ phase: Phase.ChooseKeyPassphrase });\n    };\n\n    private onPassPhraseNextClick = async (e: React.FormEvent): Promise<void> => {\n        e.preventDefault();\n        if (!this.passphraseField.current) return; // unmounting\n\n        await this.passphraseField.current.validate({ allowEmpty: false });\n        if (!this.passphraseField.current.state.valid) {\n            this.passphraseField.current.focus();\n            this.passphraseField.current.validate({ allowEmpty: false, focused: true });\n            return;\n        }\n\n        this.setState({ phase: Phase.PassphraseConfirm });\n    };\n\n    private onPassPhraseConfirmNextClick = async (e: React.FormEvent): Promise<void> => {\n        e.preventDefault();\n\n        if (this.state.passPhrase !== this.state.passPhraseConfirm) return;\n\n        this.recoveryKey = await MatrixClientPeg.safeGet()\n            .getCrypto()!\n            .createRecoveryKeyFromPassphrase(this.state.passPhrase);\n        this.setState({\n            copied: false,\n            downloaded: false,\n            setPassphrase: true,\n            phase: Phase.ShowKey,\n        });\n    };\n\n    private onSetAgainClick = (): void => {\n        this.setState({\n            passPhrase: \"\",\n            passPhraseValid: false,\n            passPhraseConfirm: \"\",\n            phase: Phase.Passphrase,\n        });\n    };\n\n    private onPassPhraseValidate = (result: IValidationResult): void => {\n        this.setState({\n            passPhraseValid: !!result.valid,\n        });\n    };\n\n    private onPassPhraseChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\n        this.setState({\n            passPhrase: e.target.value,\n        });\n    };\n\n    private onPassPhraseConfirmChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\n        this.setState({\n            passPhraseConfirm: e.target.value,\n        });\n    };\n\n    private renderOptionKey(): JSX.Element {\n        return (\n            <StyledRadioButton\n                key={SecureBackupSetupMethod.Key}\n                value={SecureBackupSetupMethod.Key}\n                name=\"keyPassphrase\"\n                checked={this.state.passPhraseKeySelected === SecureBackupSetupMethod.Key}\n                onChange={this.onKeyPassphraseChange}\n                outlined\n            >\n                <div className=\"mx_CreateSecretStorageDialog_optionTitle\">\n                    <span className=\"mx_CreateSecretStorageDialog_optionIcon mx_CreateSecretStorageDialog_optionIcon_secureBackup\" />\n                    {_t(\"settings|key_backup|setup_secure_backup|generate_security_key_title\")}\n                </div>\n                <div>{_t(\"settings|key_backup|setup_secure_backup|generate_security_key_description\")}</div>\n            </StyledRadioButton>\n        );\n    }\n\n    private renderOptionPassphrase(): JSX.Element {\n        return (\n            <StyledRadioButton\n                key={SecureBackupSetupMethod.Passphrase}\n                value={SecureBackupSetupMethod.Passphrase}\n                name=\"keyPassphrase\"\n                checked={this.state.passPhraseKeySelected === SecureBackupSetupMethod.Passphrase}\n                onChange={this.onKeyPassphraseChange}\n                outlined\n            >\n                <div className=\"mx_CreateSecretStorageDialog_optionTitle\">\n                    <span className=\"mx_CreateSecretStorageDialog_optionIcon mx_CreateSecretStorageDialog_optionIcon_securePhrase\" />\n                    {_t(\"settings|key_backup|setup_secure_backup|enter_phrase_title\")}\n                </div>\n                <div>{_t(\"settings|key_backup|setup_secure_backup|use_phrase_only_you_know\")}</div>\n            </StyledRadioButton>\n        );\n    }\n\n    private renderPhaseChooseKeyPassphrase(): JSX.Element {\n        const setupMethods = getSecureBackupSetupMethods(MatrixClientPeg.safeGet());\n        const optionKey = setupMethods.includes(SecureBackupSetupMethod.Key) ? this.renderOptionKey() : null;\n        const optionPassphrase = setupMethods.includes(SecureBackupSetupMethod.Passphrase)\n            ? this.renderOptionPassphrase()\n            : null;\n\n        return (\n            <form onSubmit={this.onChooseKeyPassphraseFormSubmit}>\n                <p className=\"mx_CreateSecretStorageDialog_centeredBody\">\n                    {_t(\"settings|key_backup|setup_secure_backup|description\")}\n                </p>\n                <div className=\"mx_CreateSecretStorageDialog_primaryContainer\" role=\"radiogroup\">\n                    {optionKey}\n                    {optionPassphrase}\n                </div>\n                <DialogButtons\n                    primaryButton={_t(\"action|continue\")}\n                    onPrimaryButtonClick={this.onChooseKeyPassphraseFormSubmit}\n                    onCancel={this.onCancelClick}\n                    hasCancel={this.state.canSkip}\n                />\n            </form>\n        );\n    }\n\n    private renderPhasePassPhrase(): JSX.Element {\n        return (\n            <form onSubmit={this.onPassPhraseNextClick}>\n                <p>{_t(\"settings|key_backup|setup_secure_backup|enter_phrase_description\")}</p>\n\n                <div className=\"mx_CreateSecretStorageDialog_passPhraseContainer\">\n                    <PassphraseField\n                        id=\"mx_passPhraseInput\"\n                        className=\"mx_CreateSecretStorageDialog_passPhraseField\"\n                        onChange={this.onPassPhraseChange}\n                        minScore={PASSWORD_MIN_SCORE}\n                        value={this.state.passPhrase}\n                        onValidate={this.onPassPhraseValidate}\n                        fieldRef={this.passphraseField}\n                        autoFocus={true}\n                        label={_td(\"settings|key_backup|setup_secure_backup|enter_phrase_title\")}\n                        labelEnterPassword={_td(\"settings|key_backup|setup_secure_backup|enter_phrase_title\")}\n                        labelStrongPassword={_td(\"settings|key_backup|setup_secure_backup|phrase_strong_enough\")}\n                        labelAllowedButUnsafe={_td(\"settings|key_backup|setup_secure_backup|phrase_strong_enough\")}\n                    />\n                </div>\n\n                <DialogButtons\n                    primaryButton={_t(\"action|continue\")}\n                    onPrimaryButtonClick={this.onPassPhraseNextClick}\n                    hasCancel={false}\n                    disabled={!this.state.passPhraseValid}\n                >\n                    <button type=\"button\" onClick={this.onCancelClick} className=\"danger\">\n                        {_t(\"action|cancel\")}\n                    </button>\n                </DialogButtons>\n            </form>\n        );\n    }\n\n    private renderPhasePassPhraseConfirm(): JSX.Element {\n        let matchText;\n        let changeText;\n        if (this.state.passPhraseConfirm === this.state.passPhrase) {\n            matchText = _t(\"settings|key_backup|setup_secure_backup|pass_phrase_match_success\");\n            changeText = _t(\"settings|key_backup|setup_secure_backup|use_different_passphrase\");\n        } else if (!this.state.passPhrase.startsWith(this.state.passPhraseConfirm)) {\n            // only tell them they're wrong if they've actually gone wrong.\n            // Security conscious readers will note that if you left element-web unattended\n            // on this screen, this would make it easy for a malicious person to guess\n            // your passphrase one letter at a time, but they could get this faster by\n            // just opening the browser's developer tools and reading it.\n            // Note that not having typed anything at all will not hit this clause and\n            // fall through so empty box === no hint.\n            matchText = _t(\"settings|key_backup|setup_secure_backup|pass_phrase_match_failed\");\n            changeText = _t(\"settings|key_backup|setup_secure_backup|set_phrase_again\");\n        }\n\n        let passPhraseMatch: JSX.Element | undefined;\n        if (matchText) {\n            passPhraseMatch = (\n                <div>\n                    <div>{matchText}</div>\n                    <AccessibleButton kind=\"link\" onClick={this.onSetAgainClick}>\n                        {changeText}\n                    </AccessibleButton>\n                </div>\n            );\n        }\n        return (\n            <form onSubmit={this.onPassPhraseConfirmNextClick}>\n                <p>{_t(\"settings|key_backup|setup_secure_backup|enter_phrase_to_confirm\")}</p>\n                <div className=\"mx_CreateSecretStorageDialog_passPhraseContainer\">\n                    <PassphraseConfirmField\n                        id=\"mx_passPhraseInput\"\n                        onChange={this.onPassPhraseConfirmChange}\n                        value={this.state.passPhraseConfirm}\n                        className=\"mx_CreateSecretStorageDialog_passPhraseField\"\n                        label={_td(\"settings|key_backup|setup_secure_backup|confirm_security_phrase\")}\n                        labelRequired={_td(\"settings|key_backup|setup_secure_backup|confirm_security_phrase\")}\n                        labelInvalid={_td(\"settings|key_backup|setup_secure_backup|pass_phrase_match_failed\")}\n                        autoFocus={true}\n                        password={this.state.passPhrase}\n                    />\n                    <div className=\"mx_CreateSecretStorageDialog_passPhraseMatch\">{passPhraseMatch}</div>\n                </div>\n                <DialogButtons\n                    primaryButton={_t(\"action|continue\")}\n                    onPrimaryButtonClick={this.onPassPhraseConfirmNextClick}\n                    hasCancel={false}\n                    disabled={this.state.passPhrase !== this.state.passPhraseConfirm}\n                >\n                    <button type=\"button\" onClick={this.onCancelClick} className=\"danger\">\n                        {_t(\"action|skip\")}\n                    </button>\n                </DialogButtons>\n            </form>\n        );\n    }\n\n    private renderPhaseShowKey(): JSX.Element {\n        let continueButton: JSX.Element;\n        if (this.state.phase === Phase.ShowKey) {\n            continueButton = (\n                <DialogButtons\n                    /* :TCHAP: cross-signing-ui\n                    primaryButton={_t(\"action|continue\")}\n                    disabled={!this.state.downloaded && !this.state.copied && !this.state.setPassphrase}\n                    */\n                    primaryButton={_t(\"I wrote down my code\")}\n                    primaryDisabled={!this.state.downloaded && !this.state.copied && !this.state.setPassphrase}\n                    // end :TCHAP:\n\n                    onPrimaryButtonClick={this.onShowKeyContinueClick}\n\n                    /* :TCHAP: cross-signing-ui\n                    hasCancel={false}\n                    */\n                    hasCancel={true}\n                    onCancel={this.onCancel}\n                    cancelButtonClass=\"mx_AccessibleButton mx_AccessibleButton_hasKind mx_AccessibleButton_kind_danger_outline\"\n                    // end :TCHAP:\n                />\n            );\n        } else {\n            continueButton = (\n                <div className=\"mx_CreateSecretStorageDialog_continueSpinner\">\n                    <InlineSpinner />\n                </div>\n            );\n        }\n\n        return (\n            <div>\n                {/* tchap: add this <p /> */}\n                <p>{_t(\"This is your recovery key\")}</p>\n                <p><b>{_t(\"Warning: this is the only time this code will be displayed!\")}</b></p>\n                {/* end tchap */}\n                <p>{_t(\"settings|key_backup|setup_secure_backup|security_key_safety_reminder\")}</p>\n                <div className=\"mx_CreateSecretStorageDialog_primaryContainer mx_CreateSecretStorageDialog_recoveryKeyPrimarycontainer\">\n                    <div className=\"mx_CreateSecretStorageDialog_recoveryKeyContainer\">\n                        <div className=\"mx_CreateSecretStorageDialog_recoveryKey\">\n                            <code ref={this.recoveryKeyNode}>{this.recoveryKey?.encodedPrivateKey}</code>\n                        </div>\n                        <div className=\"mx_CreateSecretStorageDialog_recoveryKeyButtons\">\n                            {/* :TCHAP: cross-signing-ui - remove\n                            <AccessibleButton\n                                kind=\"primary\"\n                                className=\"mx_Dialog_primary\"\n                                onClick={this.onDownloadClick}\n                                disabled={this.state.phase === Phase.Storing}\n                            >\n                                {_t(\"action|download\")}\n                            </AccessibleButton>\n                            <span>\n                                {_t(\"settings|key_backup|setup_secure_backup|download_or_copy\", {\n                                    downloadButton: \"\",\n                                    copyButton: \"\",\n                                })}\n                            </span>\n                            end :TCHAP: */}\n                            <AccessibleButton\n                                kind=\"primary\"\n                                className=\"mx_Dialog_primary mx_CreateSecretStorageDialog_recoveryKeyButtons_copyBtn\"\n                                onClick={this.onCopyClick}\n                                disabled={this.state.phase === Phase.Storing}\n                            >\n                                {this.state.copied ? _t(\"common|copied\") : _t(\"action|copy\")}\n                            </AccessibleButton>\n                        </div>\n                    </div>\n                </div>\n                {continueButton}\n            </div>\n        );\n    }\n\n    private renderBusyPhase(): JSX.Element {\n        return (\n            <div>\n                <Spinner />\n            </div>\n        );\n    }\n\n    private renderStoredPhase(): JSX.Element {\n        return (\n            <>\n                <p className=\"mx_Dialog_content\">\n                    {_t(\"settings|key_backup|setup_secure_backup|backup_setup_success_description\")}\n                </p>\n                <DialogButtons\n                    primaryButton={_t(\"action|done\")}\n                    onPrimaryButtonClick={() => this.props.onFinished(true)}\n                    hasCancel={false}\n                />\n            </>\n        );\n    }\n\n    private renderPhaseLoadError(): JSX.Element {\n        return (\n            <div>\n                <p>{_t(\"settings|key_backup|setup_secure_backup|secret_storage_query_failure\")}</p>\n                <div className=\"mx_Dialog_buttons\">\n                    <DialogButtons\n                        primaryButton={_t(\"action|retry\")}\n                        onPrimaryButtonClick={this.onLoadRetryClick}\n                        hasCancel={this.state.canSkip}\n                        onCancel={this.onCancel}\n                    />\n                </div>\n            </div>\n        );\n    }\n\n    private renderPhaseSkipConfirm(): JSX.Element {\n        return (\n            <div>\n                <p>{_t(\"settings|key_backup|setup_secure_backup|cancel_warning\")}</p>\n                <p>{_t(\"settings|key_backup|setup_secure_backup|settings_reminder\")}</p>\n                <DialogButtons\n                    primaryButton={_t(\"action|go_back\")}\n                    onPrimaryButtonClick={this.onGoBackClick}\n                    hasCancel={false}\n                >\n                    <button type=\"button\" className=\"danger\" onClick={this.onCancel}>\n                        {_t(\"action|cancel\")}\n                    </button>\n                </DialogButtons>\n            </div>\n        );\n    }\n\n    private titleForPhase(phase: Phase): string {\n        switch (phase) {\n            case Phase.ChooseKeyPassphrase:\n                return _t(\"encryption|set_up_toast_title\");\n            case Phase.Passphrase:\n                return _t(\"settings|key_backup|setup_secure_backup|title_set_phrase\");\n            case Phase.PassphraseConfirm:\n                return _t(\"settings|key_backup|setup_secure_backup|title_confirm_phrase\");\n            case Phase.ConfirmSkip:\n                return _t(\"common|are_you_sure\");\n            case Phase.ShowKey:\n                return _t(\"settings|key_backup|setup_secure_backup|title_save_key\");\n            case Phase.Storing:\n                return _t(\"encryption|bootstrap_title\");\n            case Phase.Stored:\n                return _t(\"settings|key_backup|setup_secure_backup|backup_setup_success_title\");\n            default:\n                return \"\";\n        }\n    }\n\n    private get topComponent(): React.ReactNode | null {\n        if (this.state.phase === Phase.Stored) {\n            return <CheckmarkIcon className=\"mx_Icon mx_Icon_circle-40 mx_Icon_accent mx_Icon_bg-accent-light\" />;\n        }\n\n        return null;\n    }\n\n    private get classNames(): string {\n        return classNames(\"mx_CreateSecretStorageDialog\", {\n            mx_SuccessDialog: this.state.phase === Phase.Stored,\n        });\n    }\n\n    public render(): React.ReactNode {\n        let content;\n        if (this.state.error) {\n            content = (\n                <div>\n                    <p>{_t(\"settings|key_backup|setup_secure_backup|unable_to_setup\")}</p>\n                    <div className=\"mx_Dialog_buttons\">\n                        <DialogButtons\n                            primaryButton={_t(\"action|retry\")}\n                            onPrimaryButtonClick={this.bootstrapSecretStorage}\n                            hasCancel={this.state.canSkip}\n                            onCancel={this.onCancel}\n                        />\n                    </div>\n                </div>\n            );\n        } else {\n            switch (this.state.phase) {\n                case Phase.Loading:\n                    content = this.renderBusyPhase();\n                    break;\n                case Phase.LoadError:\n                    content = this.renderPhaseLoadError();\n                    break;\n                case Phase.ChooseKeyPassphrase:\n                    content = this.renderPhaseChooseKeyPassphrase();\n                    break;\n                case Phase.Passphrase:\n                    content = this.renderPhasePassPhrase();\n                    break;\n                case Phase.PassphraseConfirm:\n                    content = this.renderPhasePassPhraseConfirm();\n                    break;\n                case Phase.ShowKey:\n                    content = this.renderPhaseShowKey();\n                    break;\n                case Phase.Storing:\n                    content = this.renderBusyPhase();\n                    break;\n                case Phase.Stored:\n                    content = this.renderStoredPhase();\n                    break;\n                case Phase.ConfirmSkip:\n                    content = this.renderPhaseSkipConfirm();\n                    break;\n            }\n        }\n\n        let titleClass: string | string[] | undefined;\n        switch (this.state.phase) {\n            case Phase.Passphrase:\n            case Phase.PassphraseConfirm:\n                titleClass = [\n                    \"mx_CreateSecretStorageDialog_titleWithIcon\",\n                    \"mx_CreateSecretStorageDialog_securePhraseTitle\",\n                ];\n                break;\n            case Phase.ShowKey:\n                titleClass = [\n                    \"mx_CreateSecretStorageDialog_titleWithIcon\",\n                    \"mx_CreateSecretStorageDialog_secureBackupTitle\",\n                ];\n                break;\n            case Phase.ChooseKeyPassphrase:\n                titleClass = \"mx_CreateSecretStorageDialog_centeredTitle\";\n                break;\n        }\n\n        return (\n            <BaseDialog\n                className={this.classNames}\n                onFinished={this.props.onFinished}\n                top={this.topComponent}\n                title={this.titleForPhase(this.state.phase)}\n                titleClass={titleClass}\n                hasCancel={this.props.hasCancel && [Phase.Passphrase].includes(this.state.phase)}\n                fixedWidth={false}\n            >\n                <div>{content}</div>\n            </BaseDialog>\n        );\n    }\n}\n","/*\nCopyright 2024 New Vector Ltd.\nCopyright 2021 The Matrix.org Foundation C.I.C.\n\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only\nPlease see LICENSE files in the repository root for full details.\n*/\n\nimport React, { ComponentProps, PureComponent, RefCallback, RefObject } from \"react\";\n\nimport Field, { IInputProps } from \"../elements/Field\";\nimport withValidation, { IFieldState, IValidationResult } from \"../elements/Validation\";\nimport { _t, _td, TranslationKey } from \"../../../languageHandler\";\n\ninterface IProps extends Omit<IInputProps, \"onValidate\" | \"label\" | \"element\"> {\n    id?: string;\n    fieldRef?: RefCallback<Field> | RefObject<Field>;\n    autoComplete?: string;\n    value: string;\n    password: string; // The password we're confirming\n\n    label: TranslationKey;\n    labelRequired: TranslationKey;\n    labelInvalid: TranslationKey;\n    tooltipAlignment?: ComponentProps<typeof Field>[\"tooltipAlignment\"];\n    onChange(ev: React.FormEvent<HTMLElement>): void;\n    onValidate?(result: IValidationResult): void;\n}\n\nclass PassphraseConfirmField extends PureComponent<IProps> {\n    public static defaultProps = {\n        label: _td(\"auth|change_password_confirm_label\"),\n        labelRequired: _td(\"auth|change_password_confirm_label\"),\n        labelInvalid: _td(\"auth|change_password_confirm_invalid\"),\n    };\n\n    private validate = withValidation({\n        rules: [\n            {\n                key: \"required\",\n                test: ({ value, allowEmpty }) => allowEmpty || !!value,\n                invalid: () => _t(this.props.labelRequired),\n            },\n            {\n                key: \"match\",\n                test: ({ value }) => !value || value === this.props.password,\n                invalid: () => _t(this.props.labelInvalid),\n            },\n        ],\n    });\n\n    private onValidate = async (fieldState: IFieldState): Promise<IValidationResult> => {\n        const result = await this.validate(fieldState);\n        if (this.props.onValidate) {\n            this.props.onValidate(result);\n        }\n\n        return result;\n    };\n\n    public render(): React.ReactNode {\n        return (\n            <Field\n                id={this.props.id}\n                ref={this.props.fieldRef}\n                type=\"password\"\n                label={_t(this.props.label)}\n                autoComplete={this.props.autoComplete}\n                value={this.props.value}\n                onChange={this.props.onChange}\n                onValidate={this.onValidate}\n                autoFocus={this.props.autoFocus}\n                tooltipAlignment={this.props.tooltipAlignment}\n            />\n        );\n    }\n}\n\nexport default PassphraseConfirmField;\n","import React from \"react\";\nimport { IFieldState, IValidationResult } from \"~tchap-web/src/components/views/elements/Validation\";\nimport { _t } from \"~tchap-web/src/languageHandler\";\n\nimport TchapApi from \"./TchapApi\";\nimport TchapUtils from \"./TchapUtils\";\n\n/**\n * Strong Password utils.\n * File copied from v2 and modified.\n */\nexport default class TchapStrongPassword {\n    private static passwordRules: { ruleName: string; ruleValue: number | string } | null = null;\n\n    /**\n     * Query password_policy rules from a homeserver, and cache them.\n     * They look something like :\n     * {\"m.minimum_length\":8,\"m.require_digit\":true,\"m.require_symbol\":true,\"m.require_lowercase\":true,\"m.require_uppercase\":true}\n     */\n    private static async getRules() {\n        if (!this.passwordRules) {\n            const hsUrl = TchapUtils.randomHomeServer().base_url;\n            const res = await fetch(`${hsUrl}${TchapApi.passwordRulesUrl}`);\n            this.passwordRules = await res.json();\n        }\n        return this.passwordRules;\n    }\n\n    /**\n     * Replacement for PassphraseField.validate in matrix-react-sdk, with same inputs and outputs.\n     */\n    static validate = async (fieldState: IFieldState): Promise<IValidationResult> => {\n        const passwordValue: string = fieldState.value;\n\n        const rules = await this.getRules();\n\n        const applyRule = (ruleName: string, ruleValue): string => {\n            switch (ruleName) {\n                case \"m.minimum_length\":\n                    return this.minimumLength(passwordValue, ruleValue)\n                        ? \"\"\n                        : _t(\"a minimum of %(number)s characters\", { number: ruleValue });\n                case \"m.require_digit\":\n                    return this.requireDigit(passwordValue, ruleValue) ? \"\" : _t(\"a number\");\n                case \"m.require_symbol\":\n                    return this.requireSymbol(passwordValue, ruleValue) ? \"\" : _t(\"a symbol\");\n                case \"m.require_lowercase\":\n                    return this.requireLowercase(passwordValue, ruleValue) ? \"\" : _t(\"a lowercase letter\");\n                case \"m.require_uppercase\":\n                    return this.requireUppercase(passwordValue, ruleValue) ? \"\" : _t(\"an uppercase letter\");\n                default:\n                    throw new Error(\"Unknown password rule : \" + ruleName);\n            }\n        };\n\n        const errors: string[] = Object.entries(rules).reduce((errors: string[], [ruleName, ruleValue]) => {\n            const error: string = applyRule(ruleName, ruleValue);\n            if (error.length) {\n                errors.push(error);\n            }\n            return errors;\n        }, []);\n\n        if (errors.length === 0) {\n            return {\n                valid: true,\n            };\n        }\n\n        return {\n            valid: false,\n            feedback: (\n                <div className=\"mx_Validation mx_Validation_invalid\">\n                    <div className=\"mx_Validation_description mx_Validation_invalid\">\n                        {_t(\"Your password must include:\")}\n                    </div>\n                    <ul className=\"mx_Validation_details\">\n                        {errors.map((error) => {\n                            return <li className=\"mx_Validation_detail mx_Validation_invalid\">{error}</li>;\n                        })}\n                    </ul>\n                </div>\n            ),\n        };\n    };\n\n    private static minimumLength(passwordValue: string, len: number): boolean {\n        return passwordValue.length >= len;\n    }\n\n    private static requireUppercase(passwordValue: string, required: boolean): boolean {\n        if (required) {\n            return /[A-Z]/.test(passwordValue);\n        }\n        return true;\n    }\n\n    private static requireSymbol(passwordValue: string, required: boolean): boolean {\n        if (required) {\n            return /[^a-zA-Z0-9]/.test(passwordValue);\n        }\n        return true;\n    }\n\n    private static requireDigit(passwordValue: string, required: boolean): boolean {\n        if (required) {\n            return /[0-9]/.test(passwordValue);\n        }\n        return true;\n    }\n\n    private static requireLowercase(passwordValue: string, required: boolean): boolean {\n        if (required) {\n            return /[a-z]/.test(passwordValue);\n        }\n        return true;\n    }\n}\n","/*\nCopyright 2024 New Vector Ltd.\nCopyright 2020 The Matrix.org Foundation C.I.C.\n\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only\nPlease see LICENSE files in the repository root for full details.\n*/\n\nimport React, { ComponentProps, PureComponent, RefCallback, RefObject } from \"react\";\nimport classNames from \"classnames\";\n\nimport type { ZxcvbnResult } from \"@zxcvbn-ts/core\";\nimport SdkConfig from \"../../../SdkConfig\";\nimport withValidation, { IFieldState, IValidationResult } from \"../elements/Validation\";\nimport { _t, _td, TranslationKey } from \"../../../languageHandler\";\nimport Field, { IInputProps } from \"../elements/Field\";\nimport { MatrixClientPeg } from \"../../../MatrixClientPeg\";\nimport TchapStrongPassword from \"~tchap-web/src/tchap/util/TchapStrongPassword\";\n\ninterface IProps extends Omit<IInputProps, \"onValidate\" | \"element\"> {\n    autoFocus?: boolean;\n    id?: string;\n    className?: string;\n    minScore: 0 | 1 | 2 | 3 | 4;\n    value: string;\n    fieldRef?: RefCallback<Field> | RefObject<Field>;\n    // Additional strings such as a username used to catch bad passwords\n    userInputs?: string[];\n\n    label: TranslationKey;\n    labelEnterPassword: TranslationKey;\n    labelStrongPassword: TranslationKey;\n    labelAllowedButUnsafe: TranslationKey;\n    tooltipAlignment?: ComponentProps<typeof Field>[\"tooltipAlignment\"];\n\n    onChange(ev: React.FormEvent<HTMLElement>): void;\n    onValidate?(result: IValidationResult): void;\n}\n\nclass PassphraseField extends PureComponent<IProps> {\n    public static defaultProps = {\n        label: _td(\"common|password\"),\n        labelEnterPassword: _td(\"auth|password_field_label\"),\n        labelStrongPassword: _td(\"auth|password_field_strong_label\"),\n        labelAllowedButUnsafe: _td(\"auth|password_field_weak_label\"),\n    };\n\n    public readonly validate = withValidation<this, ZxcvbnResult | null>({\n        description: function (complexity) {\n            const score = complexity ? complexity.score : 0;\n            return <progress className=\"mx_PassphraseField_progress\" max={4} value={score} />;\n        },\n        deriveData: async ({ value }): Promise<ZxcvbnResult | null> => {\n            if (!value) return null;\n            const { scorePassword } = await import(\"../../../utils/PasswordScorer\");\n            return scorePassword(MatrixClientPeg.get(), value, this.props.userInputs);\n        },\n        rules: [\n            {\n                key: \"required\",\n                test: ({ value, allowEmpty }) => allowEmpty || !!value,\n                invalid: () => _t(this.props.labelEnterPassword),\n            },\n            {\n                key: \"complexity\",\n                test: async function ({ value }, complexity): Promise<boolean> {\n                    if (!value || !complexity) {\n                        return false;\n                    }\n                    const safe = complexity.score >= this.props.minScore;\n                    const allowUnsafe = SdkConfig.get(\"dangerously_allow_unsafe_and_insecure_passwords\");\n                    return allowUnsafe || safe;\n                },\n                valid: function (complexity) {\n                    // Unsafe passwords that are valid are only possible through a\n                    // configuration flag. We'll print some helper text to signal\n                    // to the user that their password is allowed, but unsafe.\n                    if (complexity && complexity.score >= this.props.minScore) {\n                        return _t(this.props.labelStrongPassword);\n                    }\n                    return _t(this.props.labelAllowedButUnsafe);\n                },\n                invalid: function (complexity) {\n                    if (!complexity) {\n                        return null;\n                    }\n                    const { feedback } = complexity;\n                    return feedback.warning || feedback.suggestions[0] || _t(\"auth|password_field_keep_going_prompt\");\n                },\n            },\n        ],\n        memoize: true,\n    });\n\n    public onValidate = async (fieldState: IFieldState): Promise<IValidationResult> => {\n        // :TCHAP: password-policy - use home-made validation\n        // const result = await this.validate(fieldState);\n        const result = await TchapStrongPassword.validate(fieldState);\n        // end :TCHAP:\n        if (this.props.onValidate) {\n            this.props.onValidate(result);\n        }\n        return result;\n    };\n\n    public render(): React.ReactNode {\n        return (\n            <Field\n                id={this.props.id}\n                autoFocus={this.props.autoFocus}\n                className={classNames(\"mx_PassphraseField\", this.props.className)}\n                ref={this.props.fieldRef}\n                type=\"password\"\n                autoComplete=\"new-password\"\n                label={_t(this.props.label)}\n                value={this.props.value}\n                onChange={this.props.onChange}\n                onValidate={this.onValidate}\n                tooltipAlignment={this.props.tooltipAlignment}\n            />\n        );\n    }\n}\n\nexport default PassphraseField;\n","/*\nCopyright 2024 New Vector Ltd.\nCopyright 2024 The Matrix.org Foundation C.I.C.\n\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only\nPlease see LICENSE files in the repository root for full details.\n*/\n\nimport { logger } from \"matrix-js-sdk/src/logger\";\nimport { CryptoApi } from \"matrix-js-sdk/src/crypto-api\";\n\nimport { MatrixClientPeg } from \"../../MatrixClientPeg\";\n\n/**\n * Check if device dehydration is enabled.\n *\n * Note that this doesn't necessarily mean that device dehydration has been initialised\n * (yet) on this client; rather, it means that the server supports it, the crypto backend\n * supports it, and the application configuration suggests that it *should* be\n * initialised on this device.\n *\n * Dehydration can currently only be enabled by setting a flag in the .well-known file.\n */\nasync function deviceDehydrationEnabled(crypto: CryptoApi | undefined): Promise<boolean> {\n    if (!crypto) {\n        return false;\n    }\n    if (!(await crypto.isDehydrationSupported())) {\n        return false;\n    }\n    const wellknown = await MatrixClientPeg.safeGet().waitForClientWellKnown();\n    return !!wellknown?.[\"org.matrix.msc3814\"];\n}\n\n/**\n * If dehydration is enabled (i.e., it is supported by the server and enabled in\n * the configuration), rehydrate a device (if available) and create\n * a new dehydrated device.\n *\n * @param createNewKey: force a new dehydration key to be created, even if one\n *   already exists.  This is used when we reset secret storage.\n */\nexport async function initialiseDehydration(createNewKey: boolean = false): Promise<void> {\n    const crypto = MatrixClientPeg.safeGet().getCrypto();\n    if (await deviceDehydrationEnabled(crypto)) {\n        logger.log(\"Device dehydration enabled\");\n        await crypto!.startDehydration(createNewKey);\n    }\n}\n","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n"],"names":["Phase","CreateSecretStorageDialog","React","constructor","props","super","_defineProperty","createRef","e","this","setState","passPhraseKeySelected","target","value","async","state","SecureBackupSetupMethod","Key","recoveryKey","MatrixClientPeg","safeGet","getCrypto","createRecoveryKeyFromPassphrase","copied","downloaded","setPassphrase","phase","ShowKey","Passphrase","copyNode","recoveryKeyNode","current","blob","Blob","encodedPrivateKey","type","FileSaver","canUploadKeysWithPasswordOnly","accountPassword","makeRequest","identifier","user","getSafeUserId","password","dialogAesthetics","SSOAuthEntry","PHASE_PREAUTH","title","_t","body","continueText","continueKind","PHASE_POSTAUTH","finished","Modal","createDialog","InteractiveAuthDialog","matrixClient","aestheticsForStagePhases","LOGIN_TYPE","UNSTABLE_LOGIN_TYPE","confirmed","Error","crypto","forceReset","resetCrossSigning","backupInfo","Loading","getKeyBackupInfo","logger","error","LoadError","Storing","undefined","log","bootstrapSecretStorage","createSecretStorageKey","setupNewSecretStorage","bootstrapCrossSigning","authUploadDeviceSigningKeys","doBootstrapUIAuth","setupNewCrossSigning","resetKeyBackup","setupNewKeyBackup","initialiseDehydration","Stored","onFinished","ConfirmSkip","ChooseKeyPassphrase","preventDefault","passphraseField","validate","allowEmpty","valid","focus","focused","PassphraseConfirm","passPhrase","passPhraseConfirm","passPhraseValid","result","cli","getSecureBackupSetupMethods","includes","ModuleRunner","instance","extensions","cryptoSetup","accountPasswordCorrect","canSkip","isSecureBackupRequired","showKeyPassphraseDirectly","componentDidMount","keyFromCustomisations","initExtension","queryKeyUploadAuth","console","privateKey","uploadDeviceSigningKeys","MatrixError","data","flows","some","f","stages","length","renderOptionKey","StyledRadioButton","key","name","checked","onChange","onKeyPassphraseChange","outlined","className","renderOptionPassphrase","renderPhaseChooseKeyPassphrase","setupMethods","optionKey","optionPassphrase","onSubmit","onChooseKeyPassphraseFormSubmit","role","DialogButtons","primaryButton","onPrimaryButtonClick","onCancel","onCancelClick","hasCancel","renderPhasePassPhrase","onPassPhraseNextClick","PassphraseField","id","onPassPhraseChange","minScore","onValidate","onPassPhraseValidate","fieldRef","autoFocus","label","_td","labelEnterPassword","labelStrongPassword","labelAllowedButUnsafe","disabled","onClick","renderPhasePassPhraseConfirm","matchText","changeText","passPhraseMatch","startsWith","AccessibleButton","kind","onSetAgainClick","onPassPhraseConfirmNextClick","PassphraseConfirmField","onPassPhraseConfirmChange","labelRequired","labelInvalid","renderPhaseShowKey","_this$recoveryKey","continueButton","primaryDisabled","onShowKeyContinueClick","cancelButtonClass","InlineSpinner","ref","onCopyClick","renderBusyPhase","Spinner","renderStoredPhase","renderPhaseLoadError","onLoadRetryClick","renderPhaseSkipConfirm","onGoBackClick","titleForPhase","topComponent","CheckmarkIcon","classNames","mx_SuccessDialog","render","content","titleClass","BaseDialog","top","fixedWidth","PureComponent","args","withValidation","rules","test","invalid","fieldState","Field","autoComplete","tooltipAlignment","TchapStrongPassword","getRules","passwordRules","hsUrl","TchapUtils","randomHomeServer","base_url","res","fetch","TchapApi","passwordRulesUrl","json","minimumLength","passwordValue","len","requireUppercase","required","requireSymbol","requireDigit","requireLowercase","_TchapStrongPassword","errors","Object","entries","reduce","ruleName","ruleValue","applyRule","number","push","feedback","map","description","complexity","score","max","deriveData","scorePassword","get","userInputs","safe","SdkConfig","warning","suggestions","memoize","createNewKey","isDehydrationSupported","wellknown","waitForClientWellKnown","deviceDehydrationEnabled","startDehydration","b","autoBom","warn","XMLHttpRequest","open","responseType","onload","response","onerror","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","self","g","global","navigator","userAgent","saveAs","HTMLAnchorElement","prototype","URL","webkitURL","createElement","download","rel","href","origin","location","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","innerText","i","HTMLElement","safari","FileReader","onloadend","replace","readAsDataURL","module","exports"],"sourceRoot":""}