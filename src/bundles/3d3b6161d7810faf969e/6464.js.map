{"version":3,"file":"bundles/3d3b6161d7810faf969e/6464.js","mappings":"+lBAmCe,SAASA,GAAwB,WAAEC,IAC9C,MAAMC,GAAeC,EAAAA,EAAAA,OACdC,EAAoBC,IAAyBC,EAAAA,EAAAA,WAAS,GA0B7D,OAzBAC,EAAAA,EAAAA,YAAU,KACqBC,WACvB,MAAMC,EAASP,EAAaQ,YAC5BL,EAAsBM,QAAQF,GAA6D,aAA5CA,EAAOG,iCAA2C,EAGrGC,EAAoB,GACrB,CAACX,IAmBAY,EAAAA,cAACC,EAAAA,EAAU,CACPC,UAAU,2BACVf,WAAYA,EACZgB,MACIH,EAAAA,cAAA,QAAME,UAAU,mCACXE,EAAAA,EAAAA,IAAG,mDAIZJ,EAAAA,cAAA,UAAII,EAAAA,EAAAA,IAAG,0DACNd,GAAsBU,EAAAA,cAAA,UAAII,EAAAA,EAAAA,IAAG,0DAC9BJ,EAAAA,cAAA,UAAQE,UAAU,YAAWE,EAAAA,EAAAA,IAAG,oDAChCJ,EAAAA,cAACK,EAAAA,EAAa,CACVC,eAAeF,EAAAA,EAAAA,IAAG,gCAClBG,qBA/BZ,WACQjB,EACAH,IAEAqB,EAAAA,GAAMC,aACFC,EAAAA,EACA,CACIvB,mBAEJwB,GACA,GACA,EAGZ,EAkBYC,cAAcR,EAAAA,EAAAA,IAAG,yBACjBS,SAAUA,KACN1B,IACA2B,EAAAA,EAAIC,KAAKC,EAAAA,EAAOC,iBAAiB,IAKrD,C","sources":["webpack://element-web/./src/async-components/views/dialogs/security/NewRecoveryMethodDialog.tsx"],"sourcesContent":["/*\nCopyright 2024 New Vector Ltd.\nCopyright 2020 The Matrix.org Foundation C.I.C.\nCopyright 2018, 2019 New Vector Ltd\n\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only\nPlease see LICENSE files in the repository root for full details.\n*/\n\nimport React, { JSX, useEffect, useState } from \"react\";\n\nimport dis from \"../../../../dispatcher/dispatcher\";\nimport { _t } from \"../../../../languageHandler\";\nimport Modal from \"../../../../Modal\";\nimport RestoreKeyBackupDialog from \"../../../../components/views/dialogs/security/RestoreKeyBackupDialog\";\nimport { Action } from \"../../../../dispatcher/actions\";\nimport DialogButtons from \"../../../../components/views/elements/DialogButtons\";\nimport BaseDialog from \"../../../../components/views/dialogs/BaseDialog\";\nimport { useMatrixClientContext } from \"../../../../contexts/MatrixClientContext.tsx\";\n\n/**\n * Properties for {@link NewRecoveryMethodDialog}.\n */\ninterface NewRecoveryMethodDialogProps {\n    /**\n     * Callback when the dialog is dismissed.\n     */\n    onFinished(): void;\n}\n\n// Export as default instead of a named export so that it can be dynamically imported with React lazy\n\n/**\n * Dialog to inform the user that a new recovery method has been detected.\n */\nexport default function NewRecoveryMethodDialog({ onFinished }: NewRecoveryMethodDialogProps): JSX.Element {\n    const matrixClient = useMatrixClientContext();\n    const [isKeyBackupEnabled, setIsKeyBackupEnabled] = useState(false);\n    useEffect(() => {\n        const checkBackupEnabled = async (): Promise<void> => {\n            const crypto = matrixClient.getCrypto();\n            setIsKeyBackupEnabled(Boolean(crypto && (await crypto.getActiveSessionBackupVersion()) !== null));\n        };\n\n        checkBackupEnabled();\n    }, [matrixClient]);\n\n    function onClick(): void {\n        if (isKeyBackupEnabled) {\n            onFinished();\n        } else {\n            Modal.createDialog(\n                RestoreKeyBackupDialog,\n                {\n                    onFinished,\n                },\n                undefined,\n                false,\n                true,\n            );\n        }\n    }\n\n    return (\n        <BaseDialog\n            className=\"mx_KeyBackupFailedDialog\"\n            onFinished={onFinished}\n            title={\n                <span className=\"mx_KeyBackupFailedDialog_title\">\n                    {_t(\"encryption|new_recovery_method_detected|title\")}\n                </span>\n            }\n        >\n            <p>{_t(\"encryption|new_recovery_method_detected|description_1\")}</p>\n            {isKeyBackupEnabled && <p>{_t(\"encryption|new_recovery_method_detected|description_2\")}</p>}\n            <strong className=\"warning\">{_t(\"encryption|new_recovery_method_detected|warning\")}</strong>\n            <DialogButtons\n                primaryButton={_t(\"common|setup_secure_messages\")}\n                onPrimaryButtonClick={onClick}\n                cancelButton={_t(\"common|go_to_settings\")}\n                onCancel={() => {\n                    onFinished();\n                    dis.fire(Action.ViewUserSettings);\n                }}\n            />\n        </BaseDialog>\n    );\n}\n"],"names":["NewRecoveryMethodDialog","onFinished","matrixClient","useMatrixClientContext","isKeyBackupEnabled","setIsKeyBackupEnabled","useState","useEffect","async","crypto","getCrypto","Boolean","getActiveSessionBackupVersion","checkBackupEnabled","React","BaseDialog","className","title","_t","DialogButtons","primaryButton","onPrimaryButtonClick","Modal","createDialog","RestoreKeyBackupDialog","undefined","cancelButton","onCancel","dis","fire","Action","ViewUserSettings"],"sourceRoot":""}